const K=document.createElement("div");K.innerHTML="<div class=wb-header><div class=wb-icon><span class=wb-min></span><span class=wb-max></span><span class=wb-full></span><span class=wb-close></span></div><div class=wb-title> </div></div><div class=wb-body></div><div class=wb-n></div><div class=wb-s></div><div class=wb-w></div><div class=wb-e></div><div class=wb-nw></div><div class=wb-ne></div><div class=wb-se></div><div class=wb-sw></div>";function et(){return K.cloneNode(!0)}function f(t,i,e,o){t.addEventListener(i,e,o||o===!1?o:!0)}function W(t,i,e,o){t.removeEventListener(i,e,o||o===!1?o:!0)}function q(t,i){t.stopPropagation(),t.cancelable&&t.preventDefault()}function F(t,i){return t.getElementsByClassName(i)[0]}function Q(t,i){t.classList.add(i)}function Z(t,i){t.classList.remove(i)}function R(t,i,e){e=""+e,t["_s_"+i]!==e&&(t.style.setProperty(i,e),t["_s_"+i]=e)}function ot(t,i){t.firstChild.nodeValue=i}const B=[];let x,nt=0,I=0,T,Y,k,z,tt,p,y;function h(t,i){if(!(this instanceof h))return new h(t);T||st(),this.dom=et(),this.body=F(this.dom,"wb-body");let e,o,n,c,g,C,a,s,w,v,r,l,M,d,m,b,N,U,j,O,V,$,A,P,H,X,G;t&&(i&&(n=t,t=i),typeof t=="string"?n=t:((U=t.modal)&&(r=l="center"),e=t.id,o=t.root,n=n||t.title,c=t.mount,g=t.html,C=t.url,a=t.width,s=t.height,w=t.minwidth,v=t.minheight,r=t.x||r,l=t.y||l,M=t.max,d=t.top,m=t.left,b=t.bottom,N=t.right,T=t.index||T,j=t.onclose,O=t.onfocus,V=t.onblur,$=t.onmove,A=t.onresize,P=t.background,H=t.border,X=t.class,G=t.splitscreen,P&&this.setBackground(P),H&&R(this.body,"margin",H+(isNaN(H)?"":"px")))),this.setTitle(n||"");let L=p,E=y;d=d?u(d,E):0,b=b?u(b,E):0,m=m?u(m,L):0,N=N?u(N,L):0,L-=m+N,E-=d+b,a=a?u(a,L):L/2|0,s=s?u(s,E):E/2|0,w=w?u(w,L):0,v=v?u(v,E):0,r=r?u(r,L,a):m,l=l?u(l,E,s):d,T=T||10,this.dom.id=this.id=e||"winbox-"+ ++nt,this.dom.className="winbox"+(X?" "+(typeof X=="string"?X:X.join(" ")):"")+(U?" modal":""),this.x=r,this.y=l,this.width=a,this.height=s,this.minwidth=w,this.minheight=v,this.top=d,this.right=N,this.bottom=b,this.left=m,this.border=H,this.min=!1,this.max=!1,this.onclose=j,this.onfocus=O,this.onblur=V,this.onmove=$,this.onresize=A,this.splitscreen=G,M?this.maximize():this.move().resize(),this.focus(),c?this.mount(c):g?this.body.innerHTML=g:C&&this.setUrl(C),ht(this),(o||x).appendChild(this.dom)}h.new=function(t){return new h(t)};function u(t,i,e){if(typeof t=="string")if(t==="center")t=(i-e)/2|0;else if(t==="right"||t==="bottom")t=i-e;else{const o=parseFloat(t);(""+o!==t&&t.substring((""+o).length))==="%"?t=i/100*o|0:t=o}return t}function st(){x=document.body,x[z="requestFullscreen"]||x[z="msRequestFullscreen"]||x[z="webkitRequestFullscreen"]||x[z="mozRequestFullscreen"]||(z=""),tt=z&&z.replace("request","exit").replace("mozRequest","mozCancel").replace("Request","Exit"),f(window,"resize",function(){J(),S()}),J()}function ht(t){_(t,"title"),_(t,"n"),_(t,"s"),_(t,"w"),_(t,"e"),_(t,"nw"),_(t,"ne"),_(t,"se"),_(t,"sw"),f(F(t.dom,"wb-min"),"click",function(i){q(i),t.minimize()}),f(F(t.dom,"wb-max"),"click",function(i){q(i),t.focus().maximize()}),z?f(F(t.dom,"wb-full"),"click",function(i){q(i),t.focus().fullscreen()}):t.addClass("no-full"),f(F(t.dom,"wb-close"),"click",function(i){q(i),t.close()||(t=null)}),f(t.dom,"click",function(i){t.focus()},!1)}function D(t){B.splice(B.indexOf(t),1),S(),t.removeClass("min"),t.min=!1,t.dom.title=""}function S(){const t=B.length,i={},e={};for(let o=0,n,c;o<t;o++)n=B[o],c=n.left+":"+n.top,e[c]?e[c]++:e[c]=1;for(let o=0,n,c,g;o<t;o++)n=B[o],c=n.left+":"+n.top,g=Math.min((p-n.left-n.right)/e[c],250),i[c]||(i[c]=0),n.resize(g+1|0,35,!0).move(n.left+i[c]*g|0,y-n.bottom-35,!0),i[c]++}function _(t,i){const e=F(t.dom,"wb-"+i);let o,n,c;f(e,"mousedown",g),f(e,"touchstart",g,{passive:!1});function g(s){if(q(s),t.min)t.minimize();else{if(i==="title"){const w=Date.now(),v=w-I;if(I=w,v<250){t.maximize();return}}t.max||(Q(x,"wb-drag"),(o=s.touches)&&(o=o[0])?(s=o,f(window,"touchmove",C),f(window,"touchend",a)):(f(window,"mousemove",C),f(window,"mouseup",a)),n=s.pageX,c=s.pageY,t.focus())}}function C(s){q(s),o&&(s=s.touches[0]);const w=s.pageX,v=s.pageY,r=w-n,l=v-c;let M,d,m,b;i==="title"?(t.x+=r,t.y+=l,m=b=1):(i==="e"||i==="se"||i==="ne"?(t.width+=r,M=1):(i==="w"||i==="sw"||i==="nw")&&(t.x+=r,t.width-=r,M=1,m=1),i==="s"||i==="se"||i==="sw"?(t.height+=l,d=1):(i==="n"||i==="ne"||i==="nw")&&(t.y+=l,t.height-=l,d=1,b=1)),(M||d)&&(M&&(t.width=Math.max(Math.min(t.width,p-t.x-t.right),150)),d&&(t.height=Math.max(Math.min(t.height,y-t.y-t.bottom),35)),t.resize()),(m||b)&&(m&&(t.x=Math.max(Math.min(t.x,p-t.width-t.right),t.left)),b&&(t.y=Math.max(Math.min(t.y,y-t.height-t.bottom),t.top)),t.move()),n=w,c=v}function a(s){q(s),Z(x,"wb-drag"),o?(W(window,"touchmove",C),W(window,"touchend",a)):(W(window,"mousemove",C),W(window,"mouseup",a))}}function J(){p=x.clientWidth,y=x.clientHeight}h.prototype.mount=function(t){return this.unmount(),t._backstore||(t._backstore=t.parentNode),this.body.textContent="",this.body.appendChild(t),this};h.prototype.unmount=function(t){const i=this.body.firstChild;if(i){const e=t||i._backstore;e&&e.appendChild(i),i._backstore=t}return this};h.prototype.setTitle=function(t){return ot(F(this.dom,"wb-title"),this.title=t),this};h.prototype.setBackground=function(t){return R(this.dom,"background",t),this};h.prototype.setUrl=function(t){return this.body.innerHTML='<iframe src="'+t+'"></iframe>',this};h.prototype.focus=function(){return k!==this&&(R(this.dom,"z-index",T++),this.addClass("focus"),k&&(k.removeClass("focus"),k.onblur&&k.onblur()),k=this,this.onfocus&&this.onfocus()),this};h.prototype.hide=function(){return this.addClass("hide")};h.prototype.show=function(){return this.removeClass("hide")};h.prototype.minimize=function(t){return Y&&it(),!t&&this.min?(D(this),this.resize().move().focus()):t!==!1&&!this.min&&(B.push(this),S(),this.dom.title=this.title,this.addClass("min"),this.min=!0),this.max&&(this.removeClass("max"),this.max=!1),this};h.prototype.maximize=function(t){return(typeof t>"u"||t!==this.max)&&(this.min&&D(this),(this.max=!this.max)?this.addClass("max").resize(p-this.left-this.right,y-this.top-this.bottom,!0).move(this.left,this.top,!0):this.resize().move().removeClass("max")),this};h.prototype.fullscreen=function(t){return(typeof t>"u"||t!==Y)&&(this.min&&(this.resize().move(),D(this)),(!Y||!it())&&(this.body[z](),Y=!0)),this};function ct(){return document.fullscreen||document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement}function it(t){if(Y=!1,ct())return document[tt](),!0}h.prototype.close=function(t){if(this.onclose&&this.onclose(t))return!0;this.min&&D(this),this.unmount(),this.dom.parentNode.removeChild(this.dom),k===this&&(k=null)};h.prototype.move=function(t,i,e){return!t&&t!==0?(t=this.x,i=this.y,this.splitscreen&&(t===0?this.resize(p/2,y):t===p-this.width&&this.resize(p/2,y))):e||(this.x=t?t=u(t,p-this.left-this.right,this.width):0,this.y=i?i=u(i,y-this.top-this.bottom,this.height):0),R(this.dom,"transform","translate("+t+"px,"+i+"px)"),this.onmove&&this.onmove(t,i),this};h.prototype.resize=function(t,i,e){return!t&&t!==0?(t=this.width,i=this.height):e||(this.width=t?t=u(t,p-this.left-this.right):0,this.height=i?i=u(i,y-this.top-this.bottom):0),t=Math.max(t,this.minwidth),i=Math.max(i,this.minheight),R(this.dom,"width",t+"px"),R(this.dom,"height",i+"px"),this.onresize&&this.onresize(t,i),this};h.prototype.addClass=function(t){return Q(this.dom,t),this};h.prototype.removeClass=function(t){return Z(this.dom,t),this};export{h as default};
